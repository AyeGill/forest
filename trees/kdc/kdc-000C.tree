\title{The Whitney map, or how to stopy worrying and love discrete differential forms}
\author{kevin-carlson}
\import{macros}
\meta{comments}{true}
\date{2024-05-06}

\p{De Rham's theorem says that de Rham cohomology and simplicial cohomology of a triangulated manifold (i.e. one given as a simplicial complex) are the same. This is pretty wild, because they don't look related essentially at all. The de Rham cohomology is calculated from the smooth differential forms, which are (usually defined as) sections of the exterior powers of the cotangent bundle. That means that, pointwise, differential forms are alternating multilinear maps from lists of tangent vectors to #{\R}. (If you're not familiar, think something like the determinant function on tangent vectors to an oriented manifold.) The simplicial cohomology, on the other hand, is calculated out of simplicial cochains. The #{n}-dimensional simplicial cochain space is the dual space of the vector space spanned by the #{n}-dimensional simplices. In particular, for a compact manifold, these groups are all finite-dimensional, which is wildly untrue for the de Rham version; yet somehow when you "take cohomology" of these two families of vector spaces, you end up the same place. I'm not really going to talk about cohomology right now--it should suffice to understand that the de Rham theorem says that somehow, these two families of vector spaces are secretly the same in an appropriate category.}

\p{You learn a proof of de Rham's theorem in your algebraic topology course in, like, the second year of a math Ph.D., but even if you've done a math Ph.D. that proof is very abstract. I think the proof I learned comes from checking the axioms of a cohomology theory for differential forms! This amounts to saying that we can start with the de Rham isomorphism over a point and then extend along nice colimits that let us build all manifolds; but this means in particular that we don't get a nice sense of how the de Rham isomorphism works on a \emph{given} manifold. So I was glad to get talking to Luke Morris last week about how to pull forms back along generalized maps of simplicial complexes, namely, maps that can send a simplex of the domain into the interior of a higher-dimensional simplex of the codomain, because it turns out that understanding this requires understanding a very constructive approach to de Rham's theorem that Hassler Whitney worked out in the '50s.}

\p{The problem is basically the following. In `CombinatorialSpaces.jl` and `Decapodes.jl`, a differential form on a manifold is modelled using a theory called "discrete exterior calculus". (That's the "DEC" in "Decapodes"!) I was amazed to learn, after having avoided learning about DEC for a while, that the field defines a "discrete differential form" to be...A simplicial cochain! Thus a discrete #{1}-form, for instance, is literally just the assignment of a real number to each edge of a simplicial complex. The question we have is fully illustrated by an example like the following:}
\quiver{
% https://q.uiver.app/#q=WzAsMyxbMSwwLCJcXGJ1bGxldCJdLFswLDEsIlxcYnVsbGV0Il0sWzIsMSwiXFxidWxsZXQiXSxbMSwyLCItXFxwaSIsMCx7InN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMSwwLCIzLjIiLDAseyJzdHlsZSI6eyJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzAsMiwiNyIsMCx7InN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbNCw1LCIiLDAseyJsZXZlbCI6MSwic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZG90dGVkIn0sImhlYWQiOnsibmFtZSI6Im5vbmUifX19XV0=
\begin{tikzcd}
	& B \\
	A && C
	\arrow[""{name=0, anchor=center, inner sep=0}, "{t}", no head, from=1-2, to=2-3]
	\arrow[""{name=1, anchor=center, inner sep=0}, "{s}", no head, from=2-1, to=1-2]
	\arrow["{-u}", no head, from=2-1, to=2-3]
	\arrow[dotted, no head, from=1, to=0]
\end{tikzcd}
}
\p{Suppose I have a discrete 1-form on a 2-simplex as illustrated above. Suppose I map the 1-simplex into the interior of the 2-simplex as the horizontal dotted line. What's the "correct" way to interpolate a value of my discrete 1-form at this new 1-simplex?}

\p{From a hint Luke had found and scanning some DEC literature, it became clear that Whitney's monograph on geometric integration theory was the place to go to answer this question, so I had a nice throwback to grad school paging through that book last Friday afternoon. The first step to understand the shape of the answer is to understand how the usual definition of a differential form is stupid and misleading, at least for the purposes of understanding integration and cohomology. In a very common pattern in mathematics, people generally give a highly nontrivial theorem about a concept as if it were a definition. The \emph{definition} of a cochain, as described by Whitney, is that it's a mapping from regions of some dimension in a Euclidean space to #{\R} that can reasonably be thought of as some kind of "integration" map. An integration map should have some obvious geometric properties: (...) And Whitney is able to derive from these few points that, if you've got a cochain on a smooth manifold, then it must be determined by at least a Lipschitz-continuous differential form! Such a form can be defined initially on just polyhedral regions or even just simplices, but then extended in a Riemann-sum-type way to give values on curved bits of space, which gives you the definition of line, surface, etc integrals determined by the cochain. Super cool. I'm dwelling on this because I've always been pretty uncomfortable with the motivation for the leap from "ordinary" multivariable calculus to integration of differential forms, but Whitney shows perfectly clearly how this is geometrically absolutely necessary. Love it.}

\p{Anyway, if you think that actually, a differential form is just a nice presentation for a cochain, i.e. an "integration"-flavored mapping on nice regions of fixed dimension, then the de Rham theorem question becomes a whole lot clearer. The so-called "de Rham" map from differential forms to simplicial cochains simply evaluates a given form on the simplices of its appropriate dimension (where "evaluation" is called "integration" if you're thinking of the form in terms of its values at points.) When we give a discrete differential form, we should imagine we're giving the integral of an honest differential form over those simplices that happen to be a part of the mesh of current interest. Then to compute an interpolated value as in the diagram above, we need to know how to map in the other direction from the de Rham map. Appropriately, this "inverse-on-cohomology" is called the Whitney map! Here's how to calculate it.}

\p{As a warm-up, let's consider a #{2}-simplex with a #{0}-form #{f}, so we have a number #{f(x)} on each vertex #{X\in \{A,B,C\}}. If I pick a point #{t} in the #{2}-simplex, what's the best value of #{f(t)}? Well, one way to \emph{define} the 2-simplex is as the convex hull of #{\{A,B,C\}}. Thus by definition #{t} has a unique expression as #{aA+bB+cC} with #{a+b+c=1} and #{a,b,c\geq 0}. Then we can define #{f(t)} as #{af(A)+bf(B)+cf(C)}. #{(a,b,c)} are called the "barycentric coordinates" of #{t}.}

\p{Now let's suppose we have the 1-form #{\omega} on #{\Delta^2} given by the values in the diagram above. For each vertex #{X} let #{\varphi_X:\Delta^2\to\R} give the #{X}-component of the barycentric coordinates of a point. Then the Whitney map defines 1-forms on #{\Delta^2} corresponding to each oriented edge #{XY} as #{\varphi_{XY}=\varphi_X d\varphi_Y-\varphi_Y d\varphi_X}. For instance, suppose #{\Delta^2} is embedded in #{\R^2} at the points #{(-1,0),(0,1),(1,0)}. Then in Cartesian coordinates, #{aA+bB+cC=(c-a,b)}, so that, inverting, we have #{a(x,y)=\frac{1-x-y}2,b(x,y)=y,c(x,y)=\frac{1+x-y}{2}.} Thus #{da=\frac{-dx-dy}{2},db=dy,dc=\frac{dx-dy}{2}}, and this lets us write out the Whitney forms associated to each edge. Extending linearly gives a map from the whole 3-dimensional space of discrete 1-forms into the space of actual 1-forms. In particular, for the example above we find that the associated smooth 1-form is #{\left(\frac t2+\frac{s-t+u}{2}y\right)dx+\left(\frac{s-u}{2}-\frac{s-t+u}{2}x\right)dy}. We can compute the value of this form on a given segment by a line integral; for instance, for the dotted segment from #{(-1/2,1/2)} to #{(1/2,1/2)} we're looking at #{\int_0^1\frac t2+\frac{s-t+u}{4} dx=\frac t2+\frac{s-t+u}{4}.} This is the value of the Whitney form on the segment.}

\p{The general story is pretty well contained in the above. The only critical detail I haven't mentioned yet is that the Whitney form for an #{n}-simplex #{X_0\cdots X_n} has a formula with a constant factor you might not guess: it's #{n!} times an alternating sum of various wedge products, differentiating all but one #{\varphi_{X_i}} at a time. So for instance the Whitney form for the triangle #{ABC} shown above is #{2(adbdc-bdadc+cdbdc)}, while for a tetrahedron #{XYZW} it would be #{6(xdydzdw-ydxdzdw+zdydzdw-wdxdydz)}. (No promises on signs being correct!)}

\p{Beyond that, you might ask how to extend this to a general simplicial complex. It's actually quite easy: if #{X} is a vertex in a simplicial complex then the barycentric coordinate function #{\varphi_X} of #{X} can be defined in an obvious way on any simplex that has #{X} as a vertex, then is just zero everywhere else. Everything else continues as above. You might notice that there's one problem with this proposal, which is that the resulting functions are not very smooth. For instance if you do this on the simplicial complex with edges #{(-1,0)} and #{(0,1)} in the plane, then the function corresponding to the vertex #{1} is a RELU. So you get a piecewise-linear form, not a smooth one! This kind of makes sense as a step from simplicial complexes towards manifolds; PL differential geometry is naturally nearer by than smooth. In theory, you can then call on all the power of geometric topology to say that PL stuff is basically the same as smooth stuff and let it be; in practice, you can just "convolve with a bump function" or "use a partition of unity", in a trick that's very standard in differential topology and described in detail in the section "Elementary forms" on page 138 of Whitney's book.}